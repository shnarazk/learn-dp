#!/usr/bin/env cbqn
lib â† â€¢Import "lib.bqn"

NewVariable â‡ {F init:
  val â‡ init
  Data â‡ { ğ•¤ â‹„ val }
  Set â‡ { F v: val â†© v }
}

_asSimpleFunction â† { w _s:
  test â‡ 3
  Fn â‡ W
  Set â‡ { Fn â†© ğ• }
  Apply â‡ { Fn ğ•© }
}

_asFunction â‡ { w _s:
  Forward â‡ W
  Set â‡ { Forward â†© ğ• }
  Apply â‡ { NewVariable Forward ğ•©.val }
}

x â† NewVariable 1
F â† (1âŠ¸+)_asSimpleFunction
"F or f is a namespace"             lib.Debug f
"f contains a function â†’ f.Apply 3" lib.Debug f.Apply 3
"f has a secret store â†’ f.test"     lib.Debug f.test
G â† (1âŠ¸+)_asFunction
"G or g is a namespace"             lib.Debug g
"g contains a function â†’ g.Apply x" lib.Debug g.Apply x
y â† g.Apply x
"The return value contains answer"  lib.Debug y.val

Square â† 2âŠ¸(â‹†Ëœ)_asFunction
x10 â† NewVariable 10
"square.Apply x10" lib.Debug (square.Apply x10).Data @

Exp â† â‹†_asFunction
"Exp.Apply x"      lib.Debug (exp.Apply x).Data @
Ln â† â‹†â¼_asFunction
"Ln.Apply x10"     lib.Debug (ln.Apply x10).Data @
